# TEMPLATE - Do not edit directly
#
# Usage:
#   1. Configure .env (see .env.example)
#   2. task argocd:generate-secrets
#
# This generates secrets.sops.yaml with random passwords and encrypts it.
# Only AWS credentials and AGE key are read from .env.
---
# Route53 credentials for cert-manager DNS01 challenge
apiVersion: v1
kind: Secret
metadata:
  name: route53-credentials
  namespace: cert-manager
type: Opaque
stringData:
  access-key-id: REPLACE_ME
  secret-access-key: REPLACE_ME
  hosted-zone-id: REPLACE_ME
---
# Keycloak database credentials
apiVersion: v1
kind: Secret
metadata:
  name: keycloak-secrets
  namespace: keycloak
type: Opaque
stringData:
  db-username: keycloak
  db-password: REPLACE_ME
---
# OIDC client secrets - Keycloak reads these via placeholders in realm-import
# Same values must be used in argocd-secret and grafana-oauth below
apiVersion: v1
kind: Secret
metadata:
  name: oidc-client-secrets
  namespace: keycloak
type: Opaque
stringData:
  argocd: REPLACE_OIDC_ARGOCD
  grafana: REPLACE_OIDC_GRAFANA
---
# PostgreSQL credentials (must match keycloak db-password)
apiVersion: v1
kind: Secret
metadata:
  name: postgres-credentials
  namespace: postgres
type: kubernetes.io/basic-auth
stringData:
  username: keycloak
  password: REPLACE_ME
---
# Grafana admin credentials
apiVersion: v1
kind: Secret
metadata:
  name: grafana-admin
  namespace: monitoring
type: Opaque
stringData:
  admin-user: admin
  admin-password: REPLACE_ME
---
# Grafana OAuth client secret (must match oidc-client-secrets.grafana)
apiVersion: v1
kind: Secret
metadata:
  name: grafana-oauth
  namespace: monitoring
type: Opaque
stringData:
  GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET: REPLACE_OIDC_GRAFANA
---
# ArgoCD secret (must match oidc-client-secrets.argocd)
apiVersion: v1
kind: Secret
metadata:
  name: argocd-secret
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-secret
    app.kubernetes.io/part-of: argocd
type: Opaque
stringData:
  oidc.keycloak.clientSecret: REPLACE_OIDC_ARGOCD
---
# SOPS AGE key for ArgoCD repo-server decryption
apiVersion: v1
kind: Secret
metadata:
  name: sops-age-key
  namespace: argocd
type: Opaque
stringData:
  keys.txt: |
    # AGE-SECRET-KEY-REPLACE_ME
